<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>VideoCapture.py</title>
<meta name="GENERATOR" content="SciTE - www.Scintilla.org" />
<style type="text/css">
.S0 {
	color: #808070;
}
.S1 {
	color: #dd0000;
}
.S2 {
	font-weight: bold;
	color: #007f7f;
}
.S3 {
	color: #007f00;
}
.S4 {
	color: #007f00;
}
.S5 {
	font-weight: bold;
	color: #ff7700;
}
.S7 {
	color: #00aa00;
}
.S8 {
	font-weight: bold;
	color: #0000ff;
}
.S9 {
	font-weight: bold;
	color: #7f00aa;
}
.S10 {
	font-weight: bold;
	color: #7f3f00;
}
span {
	font-family: Verdana;
}
</style>
</head>
<body bgcolor="#f0f0f8">
<span><span class="S7">"""VideoCapture.py<br /></span>
<span class="S7"><br /></span>
<span class="S7">by Markus Gritsch &lt;gritsch@iue.tuwien.ac.at&gt;<br /></span>
<span class="S7"><br /></span>
<span class="S7">"""</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S5">import</span><span class="S0"> </span><span class="S11">vidcap</span><span class="S0"><br /></span>
<span class="S5">from</span><span class="S0"> </span><span class="S11">PIL</span><span class="S0"> </span><span class="S5">import</span><span class="S0"> </span><span class="S11">Image</span><span class="S10">,</span><span class="S0"> </span><span class="S11">ImageFont</span><span class="S10">,</span><span class="S0"> </span><span class="S11">ImageDraw</span><span class="S0"><br /></span>
<span class="S5">import</span><span class="S0"> </span><span class="S11">time</span><span class="S10">,</span><span class="S0"> </span><span class="S11">string</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S11">default_textpos</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">'bl'</span><span class="S0"> </span><span class="S1"># t=top, b=bottom;&nbsp;&nbsp;&nbsp;l=left, c=center, r=right</span><span class="S0"><br /></span>
<span class="S11">textcolor</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S2">0xffffff</span><span class="S0"><br /></span>
<span class="S11">shadowcolor</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S2">0x000000</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S5">def</span><span class="S0"> </span><span class="S9">now</span><span class="S10">():</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Returns a string containing the current date and time.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;This function is used internally by VideoCapture to generate the timestamp<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;with which a snapshot can optionally be marked.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">weekday</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span><span class="S4">'Mon'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Tue'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Wed'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Thu'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Fri'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Sat'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'Sun'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#weekday = ('Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So')</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#weekday = ('-', '-', '-', '-', '-', '-', '-')</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">y</span><span class="S10">,</span><span class="S0"> </span><span class="S11">m</span><span class="S10">,</span><span class="S0"> </span><span class="S11">d</span><span class="S10">,</span><span class="S0"> </span><span class="S11">hr</span><span class="S10">,</span><span class="S0"> </span><span class="S11">min</span><span class="S10">,</span><span class="S0"> </span><span class="S11">sec</span><span class="S10">,</span><span class="S0"> </span><span class="S11">wd</span><span class="S10">,</span><span class="S0"> </span><span class="S11">jd</span><span class="S10">,</span><span class="S0"> </span><span class="S11">dst</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">time</span><span class="S10">.</span><span class="S11">localtime</span><span class="S10">(</span><span class="S11">time</span><span class="S10">.</span><span class="S11">time</span><span class="S10">())</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">return</span><span class="S0"> </span><span class="S4">'%s:%s:%s %s %s.%s.%s'</span><span class="S0"> </span><span class="S10">%</span><span class="S0"> </span><span class="S10">(</span><span class="S11">string</span><span class="S10">.</span><span class="S11">zfill</span><span class="S10">(</span><span class="S11">hr</span><span class="S10">,</span><span class="S0"> </span><span class="S2">2</span><span class="S10">),</span><span class="S0"> </span><span class="S11">string</span><span class="S10">.</span><span class="S11">zfill</span><span class="S10">(</span><span class="S11">min</span><span class="S10">,</span><span class="S0"> </span><span class="S2">2</span><span class="S10">),</span><span class="S0"> </span><span class="S11">string</span><span class="S10">.</span><span class="S11">zfill</span><span class="S10">(</span><span class="S11">sec</span><span class="S10">,</span><span class="S0"> </span><span class="S2">2</span><span class="S10">),</span><span class="S0"> </span><span class="S11">weekday</span><span class="S10">[</span><span class="S11">wd</span><span class="S10">],</span><span class="S0"> </span><span class="S11">d</span><span class="S10">,</span><span class="S0"> </span><span class="S11">m</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S5">class</span><span class="S0"> </span><span class="S8">Device</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Create instances of this class which will then represent video devices.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;For the lifetime of the instance, the device is blocked, so it can not be<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;used by other applications (which is quite normal Windows behavior).<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;If you want to access the device from another program, you have to delete<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;the instance first (e.g. del cam).<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span><span class="S11">self</span><span class="S10">,</span><span class="S0"> </span><span class="S11">devnum</span><span class="S10">=</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S11">showVideoWindow</span><span class="S10">=</span><span class="S2">0</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""devnum:&nbsp;&nbsp;VideoCapture enumerates the available video capture devices<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on your system.&nbsp;&nbsp;If you have more than one device, specify<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the desired one here.&nbsp;&nbsp;The device number starts from 0.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showVideoWindow: 0 ... do not display a video window (the default)<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 ... display a video window<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mainly used for debugging, since the video window<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can not be closed or moved around.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">vidcap</span><span class="S10">.</span><span class="S11">new_Dev</span><span class="S10">(</span><span class="S11">devnum</span><span class="S10">,</span><span class="S0"> </span><span class="S11">showVideoWindow</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">normalfont</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">ImageFont</span><span class="S10">.</span><span class="S11">load_path</span><span class="S10">(</span><span class="S4">'helvetica-10.pil'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">boldfont</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">ImageFont</span><span class="S10">.</span><span class="S11">load_path</span><span class="S10">(</span><span class="S4">'helvB08.pil'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">None</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">displayPropertyPage</span><span class="S10">(</span><span class="S11">self</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""deprecated<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use the methods displayCaptureFilterProperties() and<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displayCapturePinProperties() instead.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">print</span><span class="S0"> </span><span class="S4">'WARNING: displayPropertyPage() is deprecated.'</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">print</span><span class="S0"> </span><span class="S4">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use displayCaptureFilterProperties() and displayCapturePinProperties()'</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">print</span><span class="S0"> </span><span class="S4">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instead!'</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S10">.</span><span class="S11">displaypropertypage</span><span class="S10">()</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">displayCaptureFilterProperties</span><span class="S10">(</span><span class="S11">self</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Displays a dialog containing the property page of the capture filter.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For VfW drivers you may find the option to select the resolution most<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likele here.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S10">.</span><span class="S11">displaycapturefilterproperties</span><span class="S10">()</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">displayCapturePinProperties</span><span class="S10">(</span><span class="S11">self</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Displays a dialog containing the property page of the capture pin.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For WDM drivers you may find the option to select the resolution most<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likele here.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S10">.</span><span class="S11">displaycapturepinproperties</span><span class="S10">()</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">setResolution</span><span class="S10">(</span><span class="S11">self</span><span class="S10">,</span><span class="S0"> </span><span class="S11">width</span><span class="S10">,</span><span class="S0"> </span><span class="S11">height</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Sets the capture resolution. (without dialog)<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(contributed by Don Kimber &lt;kimber@fxpal.com&gt;)<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S10">.</span><span class="S11">setresolution</span><span class="S10">(</span><span class="S11">width</span><span class="S10">,</span><span class="S0"> </span><span class="S11">height</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">getBuffer</span><span class="S10">(</span><span class="S11">self</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Returns a string containing the raw pixel data.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You probably don't want to use this function, but rather getImage() or<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveSnapshot().<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">return</span><span class="S0"> </span><span class="S11">self</span><span class="S10">.</span><span class="S11">dev</span><span class="S10">.</span><span class="S11">getbuffer</span><span class="S10">()</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">getImage</span><span class="S10">(</span><span class="S11">self</span><span class="S10">,</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S10">=</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S11">boldfont</span><span class="S10">=</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">=</span><span class="S11">default_textpos</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Returns a PIL Image instance.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;&nbsp;0 ... no timestamp (the default)<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 ... simple timestamp<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 ... timestamp with shadow<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 ... timestamp with outline<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boldfont:&nbsp;&nbsp;&nbsp;0 ... normal font (the default)<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 ... bold font<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textpos:&nbsp;&nbsp;&nbsp;&nbsp;The position of the timestamp can be specified by a string<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containing a combination of two characters.&nbsp;&nbsp;One character<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;must be either t or b, the other one either l, c or r.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t ... top<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b ... bottom<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l ... left<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c ... center<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r ... right<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The default value is 'bl'<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#text = now()</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">text</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">time</span><span class="S10">.</span><span class="S11">asctime</span><span class="S10">(</span><span class="S11">time</span><span class="S10">.</span><span class="S11">localtime</span><span class="S10">(</span><span class="S11">time</span><span class="S10">.</span><span class="S11">time</span><span class="S10">()))</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">buffer</span><span class="S10">,</span><span class="S0"> </span><span class="S11">width</span><span class="S10">,</span><span class="S0"> </span><span class="S11">height</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">self</span><span class="S10">.</span><span class="S11">getBuffer</span><span class="S10">()</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">buffer</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">im</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">Image</span><span class="S10">.</span><span class="S11">fromstring</span><span class="S10">(</span><span class="S4">'RGB'</span><span class="S10">,</span><span class="S0"> </span><span class="S10">(</span><span class="S11">width</span><span class="S10">,</span><span class="S0"> </span><span class="S11">height</span><span class="S10">),</span><span class="S0"> </span><span class="S11">buffer</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'raw'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'BGR'</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S10">-</span><span class="S2">1</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">boldfont</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">self</span><span class="S10">.</span><span class="S11">boldfont</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">self</span><span class="S10">.</span><span class="S11">normalfont</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">tw</span><span class="S10">,</span><span class="S0"> </span><span class="S11">th</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">.</span><span class="S11">getsize</span><span class="S10">(</span><span class="S11">text</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">tw</span><span class="S0"> </span><span class="S10">-=</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">th</span><span class="S0"> </span><span class="S10">-=</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S4">'t'</span><span class="S0"> </span><span class="S5">in</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">y</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">-</span><span class="S2">1</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">elif</span><span class="S0"> </span><span class="S4">'b'</span><span class="S0"> </span><span class="S5">in</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">y</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">height</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span><span class="S11">th</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">raise</span><span class="S0"> </span><span class="S11">ValueError</span><span class="S10">,</span><span class="S0"> </span><span class="S3">"textpos must contain exactly one out of 't', 'b'"</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S4">'l'</span><span class="S0"> </span><span class="S5">in</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">x</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">elif</span><span class="S0"> </span><span class="S4">'c'</span><span class="S0"> </span><span class="S5">in</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">x</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span><span class="S11">width</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span><span class="S11">tw</span><span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">elif</span><span class="S0"> </span><span class="S4">'r'</span><span class="S0"> </span><span class="S5">in</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">x</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span><span class="S11">width</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span><span class="S11">tw</span><span class="S10">)</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span><span class="S2">2</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">raise</span><span class="S0"> </span><span class="S11">ValueError</span><span class="S10">,</span><span class="S0"> </span><span class="S3">"textpos must contain exactly one out of 'l', 'c', 'r'"</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S11">ImageDraw</span><span class="S10">.</span><span class="S11">Draw</span><span class="S10">(</span><span class="S11">im</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S2">2</span><span class="S10">:</span><span class="S0"> </span><span class="S1"># shadow</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">+</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">+</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">+</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">+</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S0"> </span><span class="S10">&gt;=</span><span class="S0"> </span><span class="S2">3</span><span class="S10">:</span><span class="S0"> </span><span class="S1"># thin border</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">-</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">+</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">-</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">+</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S2">4</span><span class="S10">:</span><span class="S0"> </span><span class="S1"># thick border</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">-</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">-</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">+</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">-</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">-</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">+</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">+</span><span class="S2">1</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">+</span><span class="S2">1</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">shadowcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">draw</span><span class="S10">.</span><span class="S11">text</span><span class="S10">((</span><span class="S11">x</span><span class="S10">,</span><span class="S0"> </span><span class="S11">y</span><span class="S10">),</span><span class="S0"> </span><span class="S11">text</span><span class="S10">,</span><span class="S0"> </span><span class="S11">font</span><span class="S10">=</span><span class="S11">self</span><span class="S10">.</span><span class="S11">font</span><span class="S10">,</span><span class="S0"> </span><span class="S11">fill</span><span class="S10">=</span><span class="S11">textcolor</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">return</span><span class="S0"> </span><span class="S11">im</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">saveSnapshot</span><span class="S10">(</span><span class="S11">self</span><span class="S10">,</span><span class="S0"> </span><span class="S11">filename</span><span class="S10">,</span><span class="S0"> </span><span class="S11">timestamp</span><span class="S10">=</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S11">boldfont</span><span class="S10">=</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">=</span><span class="S11">default_textpos</span><span class="S10">,</span><span class="S0"> </span><span class="S10">**</span><span class="S11">keywords</span><span class="S10">):</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Saves a snapshot to the harddisk.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The filetype depends on the filename extension.&nbsp;&nbsp;Everything that PIL<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can handle can be specified (foo.jpg, foo.gif, foo.bmp, ...).<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename:&nbsp;&nbsp;&nbsp;String containing the name of the resulting file.<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;&nbsp;see getImage()<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boldfont:&nbsp;&nbsp;&nbsp;see getImage()<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textpos:&nbsp;&nbsp;&nbsp;&nbsp;see getImage()<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Additional keyword arguments can be give which are just passed to the<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save() method of the Image class.&nbsp;&nbsp;For example you can specify the<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compression level of a JPEG image by quality=75 (which is the default<br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value anyway).<br /></span>
<span class="S7"><br /></span>
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">self</span><span class="S10">.</span><span class="S11">getImage</span><span class="S10">(</span><span class="S11">timestamp</span><span class="S10">,</span><span class="S0"> </span><span class="S11">boldfont</span><span class="S10">,</span><span class="S0"> </span><span class="S11">textpos</span><span class="S10">).</span><span class="S11">save</span><span class="S10">(</span><span class="S11">filename</span><span class="S10">,</span><span class="S0"> </span><span class="S10">**</span><span class="S11">keywords</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0"><br /></span>
<span class="S5">if</span><span class="S0"> </span><span class="S11">__name__</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S4">'__main__'</span><span class="S10">:</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">import</span><span class="S0"> </span><span class="S11">shutil</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python20\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python21\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python22\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python23\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python24\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S11">shutil</span><span class="S10">.</span><span class="S11">copy</span><span class="S10">(</span><span class="S4">'VideoCapture.py'</span><span class="S10">,</span><span class="S0"> </span><span class="S4">'C:\Python25\Lib'</span><span class="S10">)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ cam = Device(devnum=0)</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ #cam.displayPropertyPage() ## deprecated</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ #cam.displayCaptureFilterProperties()</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ #cam.displayCapturePinProperties()</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ #cam.setResolution(768, 576) ## PAL</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ #cam.setResolution(352, 288) ## CIF</span><span class="S0"><br /></span>
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#~ cam.saveSnapshot('test.jpg', quality=75, timestamp=3, boldfont=1)</span><span class="S0"><br /></span>
<span class="S0"></span></span>
</body>
</html>
